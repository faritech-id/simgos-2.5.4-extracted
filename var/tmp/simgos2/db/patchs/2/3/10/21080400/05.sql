USE kemkes;
DROP PROCEDURE IF EXISTS `storePasienTerkonfirmasiTB`;
DELIMITER //
CREATE PROCEDURE `storePasienTerkonfirmasiTB`(
	IN `PNORM` INT,
	IN `PKUNJUNGAN` CHAR(19),
	IN `PDIAGNOSA` CHAR(6)
)
BEGIN
	IF NOT EXISTS(SELECT 1 FROM kemkes.terkonfirmasi_tb ttb WHERE ttb.NORM = PNORM AND ttb.KUNJUNGAN = PKUNJUNGAN AND ttb.DIAGNOSA = PDIAGNOSA LIMIT 1) THEN
		INSERT INTO terkonfirmasi_tb (NORM, KUNJUNGAN, DIAGNOSA, TANGGAL)
		VALUES (PNORM, PKUNJUNGAN, PDIAGNOSA, NOW());
	END IF;
END//
DELIMITER ;
